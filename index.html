<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="vendor.min.css" />
    <link rel="stylesheet" type="text/css" href="tepuy-editor.css" />
  </head>
  <body>
    <div id="tepuy-editor"></div>
    <script src="vendor.min.js"></script>
    <script src="tepuy-editor.js"></script>
    <!-- inject:js:disabled -->
    <!--endinject-->
    <!-- inject:template:html -->
    <!--endinject-->
    <script>
      var TepuyAPI = parent.window.TepuyAPI;
      if (TepuyAPI) {

        var props = {
          authentication: 'moodle',
          storage: 'moodle',
          theme: 'light',
          profileMenu: false,
          exit: {
            text: 'Regresar',
            action: 'https://cocreatic.org/',
            target: top
          }
        };

        if (TepuyAPI.initguid) {
          props.autoload = TepuyAPI.initguid;
        }

        if (TepuyAPI.tpl) {
          props.viewParams = {
           afterTemplatesLoadOnce: (view, templates) => {
             if (templates && templates.length) {
               templates.forEach(template => {
                 if (template.id == TepuyAPI.tpl) {
                   view.createObjectFromTemplate(template);
                 }
               });
             }
           }
         };
        }

        tepuyEditor.App.init(props);
      }
      else {
        tepuyEditor.App.init({
          //defaultView: 'editor',
          theme: 'light', //
          exit: {
            action: 'http://cocreatic.org/',
            target: top
          },
//          defaultView: 'home', //Por defecto es home
//          viewParams: {
//            afterTemplatesLoadOnce: (view, templates) => {
//              if (templates && templates.length) {
//                view.createObjectFromTemplate(templates[0]);
//              }
//            }
//          }
        });
      }
    </script>
  </body>
</html>